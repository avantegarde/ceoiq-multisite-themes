KJE.DebtServiceCalc=function(){this.DEBT_SERVICE_REQUIRED_RATIO=KJE.parameters.get("DEBT_SERVICE_REQUIRED_RATIO",1.25);this.ANNUAL_EXISTING_OBLIGATIONS=0;this.PAYMENT_CALC=1;this.ANNUAL_PERIODS=12;this.INPUT_YEARS=KJE.parameters.get("INPUT_YEARS",true);this.PERIOD_LABEL=KJE.parameters.get("MSG_MONTHLY","monthly");this.DEBT_SERVICE_SUCCESS=KJE.parameters.get("DEBT_SERVICE_SUCCESS",'Your debt service coverage of DEBT_SERVICE_COVERAGE is more than DEBT_SERVICE_REQUIRED_RATIO and there is a good chance your loan will be approved. Please click "View Report" below to continue the process and contact one of our loan officers.');this.DEBT_SERVICE_FAIL=KJE.parameters.get("DEBT_SERVICE_FAIL","Unfortunately your debt service coverage of DEBT_SERVICE_COVERAGE is not more than this.DEBT_SERVICE_REQUIRED_RATIO. You would probably not be able to qualify for for the loan above, considering the information you have given.");this.MSG_REPORT_SUCCESS=KJE.parameters.get("MSG_REPORT_SUCCESS","Your debt service coverage of DEBT_SERVICE_COVERAGE is more than DEBT_SERVICE_REQUIRED_RATIO and there is a good chance your loan will be approved. Please click here to contact one of our loan officers.");this.MSG_REPORT_FAIL=KJE.parameters.get("MSG_REPORT_FAIL","Unfortunately, your debt service coverage of DEBT_SERVICE_COVERAGE is not more than this.DEBT_SERVICE_REQUIRED_RATIO. You would probably not be able to qualify for for the loan above, considering the information you have given.");this.MSG_REPORT_LOAN=KJE.parameters.get("MSG_REPORT_LOAN","A PERIOD_LABEL payment of MONTHLY_PAYMENT at INTEREST_RATE for TERM_PERIODS periods will give you a loan amount of LOAN_AMOUNT.");this.MSG_REPORT_PAYMENT=KJE.parameters.get("MSG_REPORT_PAYMENT","A loan amount of LOAN_AMOUNT at INTEREST_RATE for TERM_PERIODS PERIOD_LABEL payments will give you a payment of MONTHLY_PAYMENT.");this.MSG_TITLE_SUCCESS=KJE.parameters.get("MSG_TITLE_SUCCESS","We're ready to talk business!*");this.MSG_TITLE_FAIL=KJE.parameters.get("MSG_TITLE_FAIL","We cannot prequalify your loan.*");this.sReturnMessage="";this.DEBT_SERVICE_MSG="";this.DEBT_REPORT_MSG="";this.MSG_TITLE="";this.DS_BALANCE=KJE.FloatArray(2);this.cats=["Required","Calculated"];this.sSchedule=new KJE.Repeating()};KJE.DebtServiceCalc.prototype.clear=function(){this.LOAN_AMOUNT=0;this.TERM=0;this.INTEREST_RATE=0;this.VERIFIABLE_NET_INCOME=0;this.DEPRECIATION_EXPENSE=0;this.OTHER_NON_CASH_CHARGES=0;this.REAL_ESTATE_MORTGAGE=0;this.BUSINESS_LINE_OF_CREDIT=0;this.AUTO_LOANS=0;this.CREDIT_CARDS=0;this.OTHER_LOANS=0;this.MONTHLY_DEBT_PAYMENTS_ELIMINATED=0;this.PROVISION_FOR_MANAGEMENT_COSTS=0;this.PROVISION_FOR_CAPITAL_EXP=0};KJE.DebtServiceCalc.prototype.calculate=function(F){var o=KJE;var u=this.LOAN_AMOUNT;var G=this.TERM;var h=this.INTEREST_RATE;var i=this.VERIFIABLE_NET_INCOME;var y=this.DEPRECIATION_EXPENSE;var j=this.OTHER_NON_CASH_CHARGES;var D=this.REAL_ESTATE_MORTGAGE;var c=this.BUSINESS_LINE_OF_CREDIT;var k=this.AUTO_LOANS;var I=this.CREDIT_CARDS;var f=this.OTHER_LOANS;var v=this.MONTHLY_DEBT_PAYMENTS_ELIMINATED;var z=this.PROVISION_FOR_MANAGEMENT_COSTS;var A=this.PROVISION_FOR_CAPITAL_EXP;var q=0;var x=0;var g=0;var m=0;if(this.INPUT_YEARS){G=G*this.ANNUAL_PERIODS}this.sReturnMessage="";if(this.PAYMENT_CALC==0){u=Math.round(KJE.PV(h/(this.ANNUAL_PERIODS*100),G,q));this.sReturnMessage=this.MSG_REPORT_LOAN}else{q=o.round(KJE.PMT(h/(this.ANNUAL_PERIODS*100),G,u),2);this.sReturnMessage=this.MSG_REPORT_PAYMENT}var r=Math.round(G);if(F){var p=this.sSchedule;p.clearRepeat();p.addHeader(p.sReportCol("#",1),p.sReportCol("Payment",2),p.sReportCol("Principal",3),p.sReportCol("Interest",4),p.sReportCol("Loan balance",5));p.addRepeat("&nbsp;","&nbsp;","&nbsp;","&nbsp;",o.dollars(u))}var b=u;var E=0;var J=0;var l=q;var w=(h/(this.ANNUAL_PERIODS*100));var s=0;for(var t=1;t<=r;t++){s=b;E=o.round(w*b,2);J=q-E;b-=J;if(b<0){l+=b;b=0;J=l-E}else{l=q}if(r==t){if(b>0.005){l+=b;b=0;J=l-E}else{b=0}}g+=l;m+=E;if(F){p.addRepeat(o.number(t),o.dollars(l,2),o.dollars(J,2),o.dollars(E,2),o.dollars(b,2))}}var C=i+y+j-z;var B=C-A;var a=D+c+k+I+f;var d=a-v;this.ANNUAL_EXISTING_OBLIGATIONS=a*12;var H=d*12+q*12;var e=B-H;if(H<0){x=100}else{x=B/H;if(x>100){x=100}}if(x>this.DEBT_SERVICE_REQUIRED_RATIO){this.DEBT_SERVICE_MSG=this.DEBT_SERVICE_SUCCESS;this.DEBT_REPORT_MSG=this.MSG_REPORT_SUCCESS;this.MSG_TITLE=this.MSG_TITLE_SUCCESS}else{this.DEBT_SERVICE_MSG=this.DEBT_SERVICE_FAIL;this.DEBT_REPORT_MSG=this.MSG_REPORT_FAIL;this.MSG_TITLE=this.MSG_TITLE_FAIL}this.DS_BALANCE[0]=this.DEBT_SERVICE_REQUIRED_RATIO;this.DS_BALANCE[1]=x;if(H<=0&&B<=0){this.DS_BALANCE[0]=0;this.DS_BALANCE[1]=0}this.INCOME_AVAILABLE_FOR_DS=B;this.MONTHLY_PAYMENT=q;this.TOTAL_OF_PAYMENTS=g;this.TOTAL_INTEREST_PAID=m;this.TOTAL_NET_CASH_INCOME=C;this.TOTAL_EXISTING_OBLIGATIONS=a;this.TOTAL_REMAINING_OBLIGATIONS=d;this.ANNUAL_DEBT_LOAD=H;this.ANNUAL_INCOME_AFTER_DEBT=e;this.DEBT_SERVICE_COVERAGE=x;this.TERM=G};KJE.DebtServiceCalc.prototype.formatReport=function(b){var c=KJE;var a=this.iDecimal;var d=b;d=KJE.replace("DEBT_SERVICE_MSG",this.DEBT_REPORT_MSG,d);d=KJE.replace("MSG_TITLE",this.MSG_TITLE,d);d=KJE.replace("RESULT_MESSAGE",this.sReturnMessage,d);d=KJE.replace("PERIOD_LABEL",this.PERIOD_LABEL,d);d=KJE.replace("ANNUAL_PERIODS",c.number(this.ANNUAL_PERIODS),d);d=KJE.replace("ANNUAL_EXISTING_OBLIGATIONS",c.dollars(this.ANNUAL_EXISTING_OBLIGATIONS),d);d=KJE.replace("LOAN_AMOUNT",c.dollars(this.LOAN_AMOUNT),d);d=KJE.replace("TERM_PERIODS",c.number(this.TERM/12,0),d);d=KJE.replace("TERM",c.number(this.TERM/12,0),d);d=KJE.replace("INTEREST_RATE",c.percent(this.INTEREST_RATE/100,3),d);d=KJE.replace("MONTHLY_PAYMENT",c.dollars(this.MONTHLY_PAYMENT,2),d);d=KJE.replace("ANNUAL_PAYMENT",c.dollars(this.MONTHLY_PAYMENT*12),d);d=KJE.replace("TOTAL_OF_PAYMENTS",c.dollars(this.TOTAL_OF_PAYMENTS,2),d);d=KJE.replace("TOTAL_INTEREST_PAID",c.dollars(this.TOTAL_INTEREST_PAID,2),d);d=KJE.replace("VERIFIABLE_NET_INCOME",c.dollars(this.VERIFIABLE_NET_INCOME),d);d=KJE.replace("DEPRECIATION_EXPENSE",c.dollars(this.DEPRECIATION_EXPENSE),d);d=KJE.replace("OTHER_NON_CASH_CHARGES",c.dollars(this.OTHER_NON_CASH_CHARGES),d);d=KJE.replace("TOTAL_NET_CASH_INCOME",c.dollars(this.TOTAL_NET_CASH_INCOME),d);d=KJE.replace("REAL_ESTATE_MORTGAGE",c.dollars(this.REAL_ESTATE_MORTGAGE),d);d=KJE.replace("BUSINESS_LINE_OF_CREDIT",c.dollars(this.BUSINESS_LINE_OF_CREDIT),d);d=KJE.replace("AUTO_LOANS",c.dollars(this.AUTO_LOANS),d);d=KJE.replace("CREDIT_CARDS",c.dollars(this.CREDIT_CARDS),d);d=KJE.replace("OTHER_LOANS",c.dollars(this.OTHER_LOANS),d);d=KJE.replace("TOTAL_EXISTING_OBLIGATIONS",c.dollars(this.TOTAL_EXISTING_OBLIGATIONS),d);d=KJE.replace("MONTHLY_DEBT_PAYMENTS_ELIMINATED",c.dollars(this.MONTHLY_DEBT_PAYMENTS_ELIMINATED),d);d=KJE.replace("ANNUAL_DEBT_PAYMENTS_ELIMINATED",c.dollars(this.MONTHLY_DEBT_PAYMENTS_ELIMINATED*12),d);d=KJE.replace("PROVISION_FOR_MANAGEMENT_COSTS",c.dollars(this.PROVISION_FOR_MANAGEMENT_COSTS),d);d=KJE.replace("PROVISION_FOR_CAPITAL_EXP",c.dollars(this.PROVISION_FOR_CAPITAL_EXP),d);d=KJE.replace("INCOME_AVAILABLE_FOR_DS",c.dollars(this.INCOME_AVAILABLE_FOR_DS),d);d=KJE.replace("TOTAL_REMAINING_OBLIGATIONS",c.dollars(this.TOTAL_REMAINING_OBLIGATIONS),d);d=KJE.replace("TOTAL_ANNUAL_REMAINING_OBLIGATIONS",c.dollars(this.TOTAL_REMAINING_OBLIGATIONS*12),d);d=KJE.replace("ANNUAL_DEBT_LOAD",c.dollars(this.ANNUAL_DEBT_LOAD),d);d=KJE.replace("ANNUAL_INCOME_AFTER_DEBT",c.dollars(this.ANNUAL_INCOME_AFTER_DEBT),d);d=KJE.replace("DEBT_SERVICE_COVERAGE",c.number(this.DEBT_SERVICE_COVERAGE,2),d);d=KJE.replace("DEBT_SERVICE_REQUIRED_RATIO",c.number(this.DEBT_SERVICE_REQUIRED_RATIO,2),d);d=d.replace("**REPEATING GROUP**",this.sSchedule.getRepeat());this.sSchedule.clearRepeat();return d};KJE.DebtServiceCalc.prototype.formatGraph=function(a,b){if(!this.NEST_EGG){b[0].setTitle(this.MSG_TITLE);b[0].setTitleGraph(this.MSG_TITLE);b[0].show(true);b[0].paint()}};KJE.DebtServiceCalc.prototype.getGraphTitle=function(b){var a="";if(b){a=this.MSG_TITLE+"<div class='KJESubTitle KJELeft'>"+this.DEBT_SERVICE_MSG+"</div>";a=KJE.replace("DEBT_SERVICE_COVERAGE",KJE.number(this.DEBT_SERVICE_COVERAGE,2),a);a=KJE.replace("DEBT_SERVICE_REQUIRED_RATIO",KJE.number(this.DEBT_SERVICE_REQUIRED_RATIO,2),a)}else{a=this.MSG_TITLE_SUCCESS+"<div class='KJESubTitle KJELeft'>"+this.DEBT_SERVICE_SUCCESS+"</div>";a=KJE.replace("DEBT_SERVICE_COVERAGE","_____",a);a=KJE.replace("DEBT_SERVICE_REQUIRED_RATIO","_____",a)}return a};KJE.CalcName="Debt Service Coverage Calculator";KJE.CalcType="DebtService2";KJE.CalculatorTitleTemplate="Debt Service Coverage";KJE.parseInputs=function(a){return a};KJE.initialize=function(){KJE.CalcControl=new KJE.DebtServiceCalc();KJE.GuiControl=new KJE.DebtService(KJE.CalcControl)};KJE.DebtService=function(j){var d=KJE;var b=KJE.gLegend;var g=KJE.inputs.items;KJE.MortgageAmtSlider("LOAN_AMOUNT","New loan amount");KJE.NumberSlider("TERM","Amortization in years",0,30,0);KJE.MortgageRateSlider("INTEREST_RATE","Interest rate");KJE.MortgageAmtSlider("VERIFIABLE_NET_INCOME","EBITDARM");KJE.Label("TOTAL_NET_CASH_INCOME","EBITDR");KJE.MortgageAmtSlider("PROVISION_FOR_MANAGEMENT_COSTS","Provision for management costs");KJE.MortgageAmtSlider("PROVISION_FOR_CAPITAL_EXP","Provision for capital expenditures");this.MSG_GRAPH_TITLE=KJE.parameters.set("MSG_GRAPH_TITLE","Required vs. Calculated Debt Service Coverage");var h=KJE.gNewGraph(KJE.gCATEGORIES,"GRAPH1",true,false,KJE.colorList[1],this.MSG_GRAPH_TITLE);h._legend.setVisible(false);h._showItemLabelOnTop=true;h._axisX._fSpacingPercent=0.2;h._showItemLabelDecimals=2;h._showItemLabel=true;h._showItemLabelFmt=d.FMT_NUMBER;h._axisY.setFormat(d.FMT_NUMBER);h._bPopDetail=true;var a=KJE.parameters.get("MSG_DROPPER_TITLE","New commercial loan:");var c=KJE.parameters.get("MSG_DROPPER_CLOSETITLE","Monthly payment KJE1");var e=function(){return a+"|"+KJE.subText(KJE.getKJEReplaced(c,d.dollars(j.MONTHLY_PAYMENT,2)),"KJERightBold")};KJE.addDropper(new KJE.Dropper("INPUTS",true,e,e),KJE.colorList[0]);var k=KJE.parameters.get("MSG_DROPPER2_TITLE","Income available for debt service:");var f=KJE.parameters.get("MSG_DROPPER2_CLOSETITLE","KJE1");var i=function(){return k+"|"+KJE.subText(KJE.getKJEReplaced(f,d.dollars(j.INCOME_AVAILABLE_FOR_DS)),"KJERightBold")};KJE.addDropper(new KJE.Dropper("INPUTS2",false,i,i),KJE.colorList[0])};KJE.DebtService.prototype.setValues=function(b){var a=KJE.inputs.items;b.LOAN_AMOUNT=a.LOAN_AMOUNT.getValue();b.TERM=a.TERM.getValue();b.INTEREST_RATE=a.INTEREST_RATE.getValue();b.VERIFIABLE_NET_INCOME=a.VERIFIABLE_NET_INCOME.getValue();b.PROVISION_FOR_MANAGEMENT_COSTS=a.PROVISION_FOR_MANAGEMENT_COSTS.getValue();b.PROVISION_FOR_CAPITAL_EXP=a.PROVISION_FOR_CAPITAL_EXP.getValue()};KJE.DebtService.prototype.refresh=function(e){var d=KJE;var c=KJE.gLegend;var b=KJE.inputs.items;var a=KJE.gGraphs[0];KJE.setTitleTemplate("Commercial Loan Calculator");a.removeAll();a.setGraphCategories(e.cats);a.add(new KJE.gGraphDataSeries(e.DS_BALANCE,"",a.getColor(1)));a.paint();a.paint();b.TOTAL_NET_CASH_INCOME.setText(d.dollars(e.TOTAL_NET_CASH_INCOME))};KJE.InputScreenText=" <div id=KJE-D-INPUTS><div id=KJE-P-INPUTS>Input information:</div></div> <div id=KJE-E-INPUTS > <div id='KJE-C-LOAN_AMOUNT'><input id='KJE-LOAN_AMOUNT' /></div> <div id='KJE-C-INTEREST_RATE'><input id='KJE-INTEREST_RATE' /></div> <div id='KJE-C-TERM'><input id='KJE-TERM' /></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS2><div id=KJE-P-INPUTS2>Input information:</div></div> <div id=KJE-E-INPUTS2 > <div id='KJE-C-VERIFIABLE_NET_INCOME'><input id='KJE-VERIFIABLE_NET_INCOME' /></div> <div id='KJE-C-PROVISION_FOR_MANAGEMENT_COSTS'><input id='KJE-PROVISION_FOR_MANAGEMENT_COSTS' /></div> <div id='KJE-C-TOTAL_NET_CASH_INCOME'><div id='KJE-TOTAL_NET_CASH_INCOME'></div></div> <div id='KJE-C-PROVISION_FOR_CAPITAL_EXP'><input id='KJE-PROVISION_FOR_CAPITAL_EXP' /></div> </div> **GRAPH1** ";KJE.DefinitionText=" <div id='KJE-D-LOAN_AMOUNT' ><dt>New loan amount</dt><dd>Total amount of your loan.</dd></div> <div id='KJE-D-TERM' ><dt>Amortization in years</dt><dd>Payment period in years.</dd></div> <div id='KJE-D-INTEREST_RATE' ><dt>Interest rate</dt><dd>Annual interest rate for this loan. Interest is calculated monthly on the current outstanding balance of your loan at 1/12 of the annual rate.</dd></div> <div id='KJE-D-MONTHLY_PAYMENT' ><dt>New monthly payment</dt><dd>Monthly payment for this loan.</dd></div> <div id='KJE-D-VERIFIABLE_NET_INCOME' ><dt>EBITDARM</dt><dd>EBITDARM represents earnings before interest, taxes (income), depreciation, amortization, rent and management fees. This represents net operating income before 'provision for management fees' and after property expenses associated with real estate taxes and insurance.</dd></div> <div id='KJE-D-PROVISION_FOR_MANAGEMENT_COSTS' ><dt>Provision for management costs</dt><dd>Lenders typically require a provision for management costs of not less than 5% of revenue. The resulting EBITDAR represents operating cash flow available for debt service (or rent as applicable), before provision for capital expenditures.</dd></div> <div id='KJE-D-TOTAL_NET_CASH_INCOME' ><dt>EBITDR</dt><dd>EBITDR represents earnings before interest, taxes (income), depreciation and rent. This represents net operating income after 'provision for management fees'.</dd></div> <div id='KJE-D-PROVISION_FOR_CAPITAL_EXP' ><dt>Provision for capital expenditures</dt><dd>Lenders typically require a provision for capital expenditures to fund capital needs associated with continuing operations.</dd></div> <div id='KJE-D-' ><dt>Debt service coverage (DSC)</dt><dd>The debt service coverage is determined by dividing the total annual income available to pay debt service by the annual debt service requirement. Lenders and investors typically seek DSC ratios of not less than 1.25.</dd></div> ";KJE.ReportText=' <h2 class=\'KJEReportHeader KJEFontHeading\'>Debt service coverage is DEBT_SERVICE_COVERAGE.</h2> **GRAPH** <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>New Commercial Loan</caption> <tr class=KJEOddRow><th class="KJELabel KJECellBorder KJECell50" >Loan amount</th><td class="KJECell KJECell50">LOAN_AMOUNT</td></tr> <tr class=KJEEvenRow><th class="KJELabel KJECellBorder">New monthly payment</th><td class="KJECell">MONTHLY_PAYMENT</td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder">Interest rate</th><td class="KJECell">INTEREST_RATE</td></tr> <tr class=KJEEvenRow><th class="KJELabel KJECellBorder">Amortization</th><td class="KJECell">TERM years</td></tr> <tr class=KJEHeaderRow><th class=KJEHeading COLSPAN=2>Your Annual Income</th></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder">EBITDARM </th><td class="KJECell"> VERIFIABLE_NET_INCOME </td></tr> <tr class=KJEEvenRow><th class="KJELabel KJECellBorder">Provision for management costs </th><td class="KJECell"> PROVISION_FOR_MANAGEMENT_COSTS </td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder">EBITDAR </th><td class="KJECell"> TOTAL_NET_CASH_INCOME </td></tr> <tr class=KJEEvenRow><th class="KJELabel KJECellBorder">Provision for capital expenditures </th><td class="KJECell"> PROVISION_FOR_CAPITAL_EXP </td></tr> <tr class=KJEOddRow><th class="KJELabel KJECellBorder">Income available for debt service </th><td class="KJECell"> INCOME_AVAILABLE_FOR_DS </td></tr> <tr class=KJEFooterRow><th class="KJELabel KJECellBorder">Debt service coverage (DSC)* </th><td class="KJECellStrong"> DEBT_SERVICE_COVERAGE </td></tr> </table> </div> <div class="KJEInset"><p class=KJEFooter>*The debt service coverage is determined by dividing the total annual income available to pay debt service by the annual debt service requirement. Lenders and investors typically seek DSC ratios of not less than DEBT_SERVICE_REQUIRED_RATIO times.</div> <h2 class=\'KJEScheduleHeader KJEFontHeading\'>Payment Schedule</h2> **REPEATING GROUP** ';