KJE.ProfitMarginCalc=function(){this.ROW_COUNT=KJE.parameters.get("ROW_COUNT",10);this.PRODUCT_NAME=new Array(this.ROW_COUNT);for(var a=0;a<this.ROW_COUNT;a++){this.PRODUCT_NAME[a]="Product #"+(a+1)}this.WHOLESALE_COST=KJE.FloatArray(this.ROW_COUNT);this.MARKUP_PERCENT=KJE.FloatArray(this.ROW_COUNT);this.SELLING_PRICE=KJE.FloatArray(this.ROW_COUNT);this.GROSS_MARGIN_DOLLARS=KJE.FloatArray(this.ROW_COUNT);this.GROSS_MARGIN_PERCENT=KJE.FloatArray(this.ROW_COUNT);this.bCalcMargin=new Array(this.ROW_COUNT);this.GROSS_MARGIN_AVG_PERCENT=0;this.MARKUP_AVG_PERCENT=0;this.SELLING_AVG_PRICE=0;this.GROSS_MARGIN_AVG_DOLLARS=0;this.WHOLESALE_AVG_COST=0;this.DISPLAY_ROW="<tr class=KJEOddRow><td class='KJELabel KJECellBorder'>PRODUCT_NAME</TD><td class='KJECell KJECellBorder'>WHOLESALE_COST</td><td class='KJECell KJECellBorder'>MARKUP_PERCENT</td><td class='KJECell KJECellBorder'>SELLING_PRICE</td><td class='KJECell KJECellBorder'>GROSS_MARGIN_DOLLARS</td><td class='KJECell'>GROSS_MARGIN_PERCENT</td></tr>"};KJE.ProfitMarginCalc.prototype.clear=function(){};KJE.ProfitMarginCalc.prototype.calculate=function(k){var d=KJE;var j=this.PRODUCT_NAME;var f=this.WHOLESALE_COST;var o=this.MARKUP_PERCENT;var g=this.SELLING_PRICE;var b=this.GROSS_MARGIN_DOLLARS;var i=this.GROSS_MARGIN_PERCENT;var h=this.bCalcMargin;this.GROSS_MARGIN_AVG_PERCENT=0;this.MARKUP_AVG_PERCENT=0;this.SELLING_AVG_PRICE=0;this.GROSS_MARGIN_AVG_DOLLARS=0;this.WHOLESALE_AVG_COST=0;var a=0;var l=this.ROW_COUNT;for(var c=0;c<l;c++){j[c]=(!j[c]?"Product #"+(c+1):j[c]);var m=o[c]/100;var e=i[c]/100;if(h[c]){if(1-i[c]==0){m=0}else{m=d.round(e/(1-e),2)}o[c]=m*100}else{if(1+m==0){e=0}else{e=d.round(m/(1+m),2)}i[c]=e*100}g[c]=d.round(f[c]*(1+m),2);b[c]=g[c]-f[c];if(f[c]>0){a++;this.GROSS_MARGIN_AVG_PERCENT+=i[c];this.MARKUP_AVG_PERCENT+=o[c];this.SELLING_AVG_PRICE+=g[c];this.GROSS_MARGIN_AVG_DOLLARS+=b[c];this.WHOLESALE_AVG_COST+=f[c]}}if(a>0){this.GROSS_MARGIN_AVG_PERCENT/=a;this.MARKUP_AVG_PERCENT/=a;this.SELLING_AVG_PRICE/=a;this.GROSS_MARGIN_AVG_DOLLARS/=a;this.WHOLESALE_AVG_COST/=a}};KJE.ProfitMarginCalc.prototype.formatReport=function(c){var d=KJE;var b=this.iDecimal;var e=c;var a="";for(var f=0;f<this.PRODUCT_NAME.length;f++){if(this.WHOLESALE_COST[f]>0){a+=this.DISPLAY_ROW;a=KJE.replace("PRODUCT_NAME",this.PRODUCT_NAME[f],a);a=KJE.replace("WHOLESALE_COST",d.dollars(this.WHOLESALE_COST[f],2),a);a=KJE.replace("MARKUP_PERCENT",d.percent(this.MARKUP_PERCENT[f]/100,2),a);a=KJE.replace("SELLING_PRICE",d.dollars(this.SELLING_PRICE[f],2),a);a=KJE.replace("GROSS_MARGIN_DOLLARS",d.dollars(this.GROSS_MARGIN_DOLLARS[f],2),a);a=KJE.replace("GROSS_MARGIN_PERCENT",d.percent(this.GROSS_MARGIN_PERCENT[f]/100,2),a)}}e=KJE.replace("<!--DISPLAY_ROWS-->",a,e);e=KJE.replace("MARKUP_AVG_PERCENT",d.percent(this.MARKUP_AVG_PERCENT/100,2),e);e=KJE.replace("GROSS_MARGIN_AVG_PERCENT",d.percent(this.GROSS_MARGIN_AVG_PERCENT/100,2),e);e=KJE.replace("SELLING_AVG_PRICE",d.dollars(this.SELLING_AVG_PRICE,2),e);e=KJE.replace("GROSS_MARGIN_AVG_DOLLARS",d.dollars(this.GROSS_MARGIN_AVG_DOLLARS,2),e);e=KJE.replace("WHOLESALE_AVG_COST",d.dollars(this.WHOLESALE_AVG_COST,2),e);return e};KJE.CalcName="Profit Margin Calculator";KJE.CalcType="ProfitMargin";KJE.CalculatorTitle="Profit Margin Calculator";KJE.initialize=function(){KJE.CalcControl=new KJE.ProfitMarginCalc();KJE.GuiControl=new KJE.ProfitMargin(KJE.CalcControl)};KJE.ProfitMargin=function(h){var e=KJE;var b=KJE.gLegend;var g=KJE.inputs.items;var i=h.ROW_COUNT;this.oldMARKUP_PERCENT=KJE.FloatArray(i);this.oldGROSS_MARGIN_PERCENT=KJE.FloatArray(i);var a=new Array(i);var c=new Array(i);var f=new Array(i);for(var d=0;d<i;d++){KJE.InputItem.AltHelpName="PRODUCT_NAME";KJE.StringInput("PRODUCT_NAME"+(d+1),"Product name");KJE.InputItem.AltHelpName="WHOLESALE_COST";KJE.DollarSlider("WHOLESALE_COST"+(d+1),"Wholesale cost",0,1000000,2);KJE.InputItem.AltHelpName="MARKUP_PERCENT";KJE.Slider("MARKUP_PERCENT"+(d+1),"Markup percent",0,900,0,KJE.FMT_PERCENT,5,[KJE.percent(0),KJE.percent(3),KJE.percent(6),KJE.percent(9)]);KJE.InputItem.AltHelpName="GROSS_MARGIN_PERCENT";KJE.PercentSlider("GROSS_MARGIN_PERCENT"+(d+1),"Gross margin percent",0,90,2,5);KJE.InputItem.AltHelpName="SELLING_PRICE";KJE.Label("SELLING_PRICE"+(d+1),"Selling price");KJE.InputItem.AltHelpName="GROSS_MARGIN_DOLLARS";KJE.Label("GROSS_MARGIN_DOLLARS"+(d+1),"Gross margin dollars")}a=KJE.parameters.get("MSG_DROPPER_TITLE","Profit Margin Calculator Inputs");c=KJE.parameters.get("MSG_DROPPER_CLOSETITLE","KJE1 Gross Margin");f[0]=function(){return h.PRODUCT_NAME[0]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[0],2)),"KJERightBold")};f[1]=function(){return h.PRODUCT_NAME[1]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[1],2)),"KJERightBold")};f[2]=function(){return h.PRODUCT_NAME[2]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[2],2)),"KJERightBold")};f[3]=function(){return h.PRODUCT_NAME[3]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[3],2)),"KJERightBold")};f[4]=function(){return h.PRODUCT_NAME[4]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[4],2)),"KJERightBold")};f[5]=function(){return h.PRODUCT_NAME[5]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[5],2)),"KJERightBold")};f[6]=function(){return h.PRODUCT_NAME[6]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[6],2)),"KJERightBold")};f[7]=function(){return h.PRODUCT_NAME[7]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[7],2)),"KJERightBold")};f[8]=function(){return h.PRODUCT_NAME[8]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[8],2)),"KJERightBold")};f[9]=function(){return h.PRODUCT_NAME[9]+"|"+KJE.subText(KJE.getKJEReplaced(c,e.dollars(h.GROSS_MARGIN_DOLLARS[9],2)),"KJERightBold")};for(var d=0;d<i;d++){KJE.addDropper(new KJE.Dropper("INPUTS"+(d+1),d==0,f[d],f[d]),KJE.colorList[0])}};KJE.ProfitMargin.prototype.setValues=function(c){var a=KJE.inputs.items;var b=c.ROW_COUNT;for(var d=0;d<b;d++){c.MARKUP_PERCENT[d]=a["MARKUP_PERCENT"+(d+1)].getValue();c.GROSS_MARGIN_PERCENT[d]=a["GROSS_MARGIN_PERCENT"+(d+1)].getValue();if(this.oldMARKUP_PERCENT[d]!=c.MARKUP_PERCENT[d]){c.bCalcMargin[d]=false}else{if(this.oldGROSS_MARGIN_PERCENT[d]!=c.GROSS_MARGIN_PERCENT[d]){c.bCalcMargin[d]=true}}c.PRODUCT_NAME[d]=a["PRODUCT_NAME"+(d+1)].getValue();c.WHOLESALE_COST[d]=a["WHOLESALE_COST"+(d+1)].getValue();c.bCalcMargin[d]=c.bCalcMargin[d]}};KJE.ProfitMargin.prototype.refresh=function(e){var d=KJE;var b=KJE.gLegend;var a=KJE.inputs.items;KJE.setTitleTemplate("Profit Margin Calculator");var c=e.ROW_COUNT;for(var f=0;f<c;f++){this.oldMARKUP_PERCENT[f]=e.MARKUP_PERCENT[f];this.oldGROSS_MARGIN_PERCENT[f]=e.GROSS_MARGIN_PERCENT[f]}for(var f=0;f<c;f++){a["MARKUP_PERCENT"+(f+1)].setValue(e.MARKUP_PERCENT[f],true);a["GROSS_MARGIN_PERCENT"+(f+1)].setValue(e.GROSS_MARGIN_PERCENT[f],true);a["GROSS_MARGIN_DOLLARS"+(f+1)].setText(d.dollars(e.GROSS_MARGIN_DOLLARS[f],2));a["SELLING_PRICE"+(f+1)].setText(d.dollars(e.SELLING_PRICE[f],2))}};KJE.InputScreenText=" <div id=KJE-D-INPUTS1><div id=KJE-P-INPUTS1>Input information:</div></div> <div id=KJE-E-INPUTS1 > <div id='KJE-C-PRODUCT_NAME1'><input id='KJE-PRODUCT_NAME1' /></div> <div id='KJE-C-WHOLESALE_COST1'><input id='KJE-WHOLESALE_COST1' /></div> <div id='KJE-C-MARKUP_PERCENT1'><input id='KJE-MARKUP_PERCENT1' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT1'><input id='KJE-GROSS_MARGIN_PERCENT1' /></div> <div id='KJE-C-SELLING_PRICE1'><div id='KJE-SELLING_PRICE1'></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS1'><div id='KJE-GROSS_MARGIN_DOLLARS1'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS2><div id=KJE-P-INPUTS2>Input information:</div></div> <div id=KJE-E-INPUTS2 > <div id='KJE-C-PRODUCT_NAME2'><input id='KJE-PRODUCT_NAME2' /></div> <div id='KJE-C-WHOLESALE_COST2'><input id='KJE-WHOLESALE_COST2' /></div> <div id='KJE-C-MARKUP_PERCENT2'><input id='KJE-MARKUP_PERCENT2' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT2'><input id='KJE-GROSS_MARGIN_PERCENT2' /></div> <div id='KJE-C-SELLING_PRICE2'><div id='KJE-SELLING_PRICE2'></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS2'><div id='KJE-GROSS_MARGIN_DOLLARS2'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS3><div id=KJE-P-INPUTS3>Input information:</div></div> <div id=KJE-E-INPUTS3 > <div id='KJE-C-PRODUCT_NAME3'><input id='KJE-PRODUCT_NAME3' /></div> <div id='KJE-C-WHOLESALE_COST3'><input id='KJE-WHOLESALE_COST3' /></div> <div id='KJE-C-MARKUP_PERCENT3'><input id='KJE-MARKUP_PERCENT3' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT3'><input id='KJE-GROSS_MARGIN_PERCENT3' /></div> <div id='KJE-C-SELLING_PRICE3'><div id='KJE-SELLING_PRICE3'></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS3'><div id='KJE-GROSS_MARGIN_DOLLARS3'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS4><div id=KJE-P-INPUTS4>Input information:</div></div> <div id=KJE-E-INPUTS4 > <div id='KJE-C-PRODUCT_NAME4'><input id='KJE-PRODUCT_NAME4' /></div> <div id='KJE-C-WHOLESALE_COST4'><input id='KJE-WHOLESALE_COST4' /></div> <div id='KJE-C-MARKUP_PERCENT4'><input id='KJE-MARKUP_PERCENT4' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT4'><input id='KJE-GROSS_MARGIN_PERCENT4' /></div> <div id='KJE-C-SELLING_PRICE4'><div id='KJE-SELLING_PRICE4'></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS4'><div id='KJE-GROSS_MARGIN_DOLLARS4'></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS5><div id=KJE-P-INPUTS5>Input information:</div></div> <div id=KJE-E-INPUTS5 > <div id='KJE-C-PRODUCT_NAME5'><input id='KJE-PRODUCT_NAME5' /></div> <div id='KJE-C-WHOLESALE_COST5'><input id='KJE-WHOLESALE_COST5' /></div> <div id='KJE-C-MARKUP_PERCENT5'><input id='KJE-MARKUP_PERCENT5' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT5'><input id='KJE-GROSS_MARGIN_PERCENT5' /></div> <div id='KJE-C-SELLING_PRICE5'><div id='KJE-SELLING_PRICE5' ></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS5'><div id='KJE-GROSS_MARGIN_DOLLARS5' ></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS6><div id=KJE-P-INPUTS6>Input information:</div></div> <div id=KJE-E-INPUTS6 > <div id='KJE-C-PRODUCT_NAME6'><input id='KJE-PRODUCT_NAME6' /></div> <div id='KJE-C-WHOLESALE_COST6'><input id='KJE-WHOLESALE_COST6' /></div> <div id='KJE-C-MARKUP_PERCENT6'><input id='KJE-MARKUP_PERCENT6' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT6'><input id='KJE-GROSS_MARGIN_PERCENT6' /></div> <div id='KJE-C-SELLING_PRICE6'><div id='KJE-SELLING_PRICE6' ></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS6'><div id='KJE-GROSS_MARGIN_DOLLARS6' ></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS7><div id=KJE-P-INPUTS7>Input information:</div></div> <div id=KJE-E-INPUTS7 > <div id='KJE-C-PRODUCT_NAME7'><input id='KJE-PRODUCT_NAME7' /></div> <div id='KJE-C-WHOLESALE_COST7'><input id='KJE-WHOLESALE_COST7' /></div> <div id='KJE-C-MARKUP_PERCENT7'><input id='KJE-MARKUP_PERCENT7' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT7'><input id='KJE-GROSS_MARGIN_PERCENT7' /></div> <div id='KJE-C-SELLING_PRICE7'><div id='KJE-SELLING_PRICE7' ></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS7'><div id='KJE-GROSS_MARGIN_DOLLARS7' ></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS8><div id=KJE-P-INPUTS8>Input information:</div></div> <div id=KJE-E-INPUTS8 > <div id='KJE-C-PRODUCT_NAME8'><input id='KJE-PRODUCT_NAME8' /></div> <div id='KJE-C-WHOLESALE_COST8'><input id='KJE-WHOLESALE_COST8' /></div> <div id='KJE-C-MARKUP_PERCENT8'><input id='KJE-MARKUP_PERCENT8' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT8'><input id='KJE-GROSS_MARGIN_PERCENT8' /></div> <div id='KJE-C-SELLING_PRICE8'><div id='KJE-SELLING_PRICE8' ></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS8'><div id='KJE-GROSS_MARGIN_DOLLARS8' ></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS9><div id=KJE-P-INPUTS9>Input information:</div></div> <div id=KJE-E-INPUTS9 > <div id='KJE-C-PRODUCT_NAME9'><input id='KJE-PRODUCT_NAME9' /></div> <div id='KJE-C-WHOLESALE_COST9'><input id='KJE-WHOLESALE_COST9' /></div> <div id='KJE-C-MARKUP_PERCENT9'><input id='KJE-MARKUP_PERCENT9' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT9'><input id='KJE-GROSS_MARGIN_PERCENT9' /></div> <div id='KJE-C-SELLING_PRICE9'><div id='KJE-SELLING_PRICE9' ></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS9'><div id='KJE-GROSS_MARGIN_DOLLARS9' ></div></div> <div style=\"height:10px\"></div> </div> <div id=KJE-D-INPUTS10><div id=KJE-P-INPUTS10>Input information:</div></div> <div id=KJE-E-INPUTS10 > <div id='KJE-C-PRODUCT_NAME10'><input id='KJE-PRODUCT_NAME10' /></div> <div id='KJE-C-WHOLESALE_COST10'><input id='KJE-WHOLESALE_COST10' /></div> <div id='KJE-C-MARKUP_PERCENT10'><input id='KJE-MARKUP_PERCENT10' /></div> <div id='KJE-C-GROSS_MARGIN_PERCENT10'><input id='KJE-GROSS_MARGIN_PERCENT10' /></div> <div id='KJE-C-SELLING_PRICE10'><div id='KJE-SELLING_PRICE10' ></div></div> <div id='KJE-C-GROSS_MARGIN_DOLLARS10'><div id='KJE-GROSS_MARGIN_DOLLARS10' ></div></div> <div style=\"height:10px\"></div> </div> ";KJE.DefinitionText=" <div id='KJE-D-PRODUCT_NAME' ><dt>Product name</dt><dd>The name of the product for this entry line. This will appear on your printed report with your results.</dd></div> <div id='KJE-D-WHOLESALE_COST' ><dt>Wholesale cost</dt><dd>Your total wholesale cost of the product that you are going to resell.</dd></div> <div id='KJE-D-MARKUP_PERCENT' ><dt>Markup percent</dt><dd>The percentage of your wholesale cost that the product's price is increased by to determine the selling price for your customers. For example, if you have a 50% markup on a product with a wholesale cost of $10, your selling price would be $15.00.</dd></div> <div id='KJE-D-SELLING_PRICE' ><dt>Selling price</dt><dd>This is the price you charge your customers. This amount is always calculated, based on either the entered gross margin percent or markup percent.</dd></div> <div id='KJE-D-GROSS_MARGIN_DOLLARS' ><dt>Gross margin dollars</dt><dd>This is the total gross margin, in dollars, for your product. For example, if you have a wholesale cost of $10 and a selling price of $15 dollars, your gross margin is $5.00.</dd></div> <div id='KJE-D-GROSS_MARGIN_PERCENT' ><dt>Gross margin percent</dt><dd>This percentage is the gross profit for your product. For example, if you have a product that has a wholesale cost of $10 and a selling price of $15, your gross margin is 33.33%.</dd></div> ";KJE.ReportText=' <!--HEADING "Profit Margin Calculator" HEADING--> <h2 class=\'KJEReportHeader KJEFontHeading\'>Profit Margin Calculator Results</h2> For the products below your average gross margin is GROSS_MARGIN_AVG_PERCENT. This represents an average selling price of SELLING_AVG_PRICE. <div class=KJEReportTableDiv><table class=KJEReportTable><caption class=\'KJEHeaderRow KJEHeading\'>Results Summary</caption> <tr class=KJEFooterRow><th class="KJELabel KJECellBorder" align=center width=20%>Product<BR>Name</th><td class="KJECellStrong KJECellBorder" align=center width=16%>Wholesale<BR>Cost</td><td class="KJECellStrong KJECellBorder" align=center width=16%>Markup<BR>percent</td><td class="KJECellStrong KJECellBorder" align=center width=16%>Selling<BR>price</td><td class="KJECellStrong KJECellBorder" align=center width=16%>Gross Margin<BR>$</td><td class="KJECellStrong" align=center width=16%>Gross Margin<BR>%</td></tr> <!--DISPLAY_ROWS--> <tr class=KJEFooterRow><th class="KJELabel KJECellBorder" align=center width=20%>Product Averages:</th><td class="KJECellStrong KJECellBorder" width=16%>WHOLESALE_AVG_COST</td><td class="KJECellStrong KJECellBorder" width=16%>MARKUP_AVG_PERCENT</td><td class="KJECellStrong KJECellBorder" width=16%>SELLING_AVG_PRICE</td><td class="KJECellStrong KJECellBorder" width=16%>GROSS_MARGIN_AVG_DOLLARS</td><td class="KJECellStrong" width=16%>GROSS_MARGIN_AVG_PERCENT</td></tr></table> </div> <BR> ';